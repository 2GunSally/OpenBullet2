<div class="row mt-1">
    <div class="mb-1">
        <span class="text-small">Label</span>
    </div>
    <app-input-text key="blockLabel"
        class="input-small w-100"
        ngDefaultControl
        (validityChange)="valueChanged()"
        [(ngModel)]="block.label"
        [placeholder]="descriptor.name" />
</div>
<div class="row mt-3">
    <div class="color-accent-light text-small">
        PARAMETERS
    </div>
</div>
<div class="row mt-2">
    <div class="col-12 px-0">
        <div class="mb-1">
            <app-bool-setting
                [parameter]="descriptor.parameters['banIfNoMatch']"
                [setting]="block.settings['banIfNoMatch']"
                (onChange)="valueChanged()" />
        </div>
    </div>
</div>
<div class="row mt-3">
    <div class="color-accent-light text-small">
        KEYCHAINS
        <button class="button button-transparent ml-2" 
            pTooltip="Add a keychain"
            (click)="addKeychain()">
            <fa-icon class="color-good" [icon]="faPlus" [fixedWidth]="true"></fa-icon>
        </button>
    </div>
</div>
<div class="row mt-1" *ngFor="let keychain of block.keychains; let i = index">
    <div class="col-12 px-0">
        <div class="keychain-wrapper" [ngStyle]="{backgroundColor: getColor(keychain)}">
            <div class="keychain" [ngStyle]="{borderColor: getColor(keychain)}">
                <div class="keychain-settings">
                    <div class="d-flex flex-row">
                        <div class="mb-1 mr-2">
                            <span class="text-small">Result status</span>
                        </div>
                        <app-input-dropdown key="resultStatus"
                            itemClass="input-small" optionClass="input-small"
                            ngDefaultControl
                            (ngModelChange)="keychainStatusChanged(keychain, $event)"
                            [displayFunction]="displayEnumValue"
                            [options]="keychainStatuses"
                            [ngModel]="keychain.resultStatus" />
                    </div>
                    <div class="d-flex flex-row">
                        <div class="mb-1 mr-2">
                            <span class="text-small">Mode</span>
                        </div>
                        <app-input-dropdown key="mode"
                            itemClass="input-small" optionClass="input-small"
                            ngDefaultControl
                            (ngModelChange)="keychainModeChanged(keychain, $event)"
                            [displayFunction]="displayEnumValue"
                            [options]="keychainModes"
                            [ngModel]="keychain.mode" />
                    </div>
                    <div class="d-flex flex-row">
                        <button class="button button-transparent" 
                            pTooltip="Add a key"
                            (click)="addKey(keychain)">
                            <fa-icon class="color-primary" [icon]="faPlus" [fixedWidth]="true"></fa-icon>
                        </button>
                        <button class="button button-transparent" 
                            pTooltip="Move keychain up"
                            (click)="moveKeychainUp(i)">
                            <fa-icon class="color-inactive" [icon]="faArrowUp" [fixedWidth]="true"></fa-icon>
                        </button>
                        <button class="button button-transparent" 
                            pTooltip="Move keychain down"
                            (click)="moveKeychainDown(i)">
                            <fa-icon class="color-inactive" [icon]="faArrowDown" [fixedWidth]="true"></fa-icon>
                        </button>
                        <button class="button button-transparent" 
                            pTooltip="Remove keychain"
                            (click)="removeKeychain(i)">
                            <fa-icon class="color-bad" [icon]="faTimes" [fixedWidth]="true"></fa-icon>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
