@page "/"
@using Helpers
@using System.Globalization
@inject Microsoft.Extensions.Localization.IStringLocalizer<Index> Loc
@attribute [Authorize(Roles = "Admin,Guest")]

<h2 style="margin-bottom: 20px;">@Loc["WelcomeMessage"]</h2>

<table class="table">
    <tbody>
        <AuthorizeView>
            <Authorized>
                <tr>
                    <th scope="row">@Loc["AuthenticatedAs"]</th>
                    <td>
                        @context.User.Identity.Name
                        <button class="btn-sm btn-primary ml-3" @onclick="Logout">@Loc["LogOut"]</button>
                    </td>
                </tr>
            </Authorized>
        </AuthorizeView>
        <tr>
            <th scope="row">@Loc["LocalTime"]</th>
            <td>@Metrics.ServerTime.ToString()</td>
        </tr>
        <tr>
            <th scope="row">@Loc["WebserverUptime"]</th>
            <td>@Metrics.UpTime.ToReadableString()</td>
        </tr>
        <tr>
            <th scope="row">@Loc["OperatingSystem"]</th>
            <td>@Metrics.OS</td>
        </tr>
        <tr>
            <th scope="row">@Loc["CurrentWorkingDirectory"]</th>
            <td>@Metrics.CWD</td>
        </tr>
        <tr>
            <th scope="row">@Loc["CPUUsage"]</th>
            <td>@(Metrics.CpuUsage.ToString("0.##", CultureInfo.InvariantCulture)) %</td>
        </tr>
        <tr>
            <th scope="row">@Loc["MemoryUsage"]</th>
            <td>@BytesToString(Metrics.MemoryUsage)</td>
        </tr>
        <tr>
            <th scope="row">@Loc["BuildNumber"]</th>
            <td>@Metrics.BuildNumber (@Metrics.BuildDate.ToString())</td>
        </tr>
        <tr>
            <th scope="row">@Loc["ClientIpAddress"]</th>
            <td>@(IP.IsIPv4MappedToIPv6 ? IP.MapToIPv4() : IP)</td>
        </tr>
    </tbody>
</table>

<BullettaHelp Title="@help1x00" Messages="new string[] { Loc[help1x01], Loc[help1x02] }" />

@code {
    string help1x00 => Loc["Help1x00"];
    string help1x01 => Loc["Help1x01"];
    string help1x02 => Loc["Help1x02"];
} 